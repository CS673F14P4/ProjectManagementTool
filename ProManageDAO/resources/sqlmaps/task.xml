<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="bu.met.cs.cs673.pm.dto.Task">
    
  <resultMap id="taskMap" type="bu.met.cs.cs673.pm.dto.Task">
  	<id property="id" column="idtask" />
  	<result property="name" column="name"/>
  	<result property="description" column="description"/>
  	<result property="startDate" column="start_date"/>
  	<result property="endDate" column="end_date"/>
  	<result property="createDate" column="create_date"/>
  	<result property="createUser" column="create_user"/>
  	<result property="lastModifiedDate" column="last_modified_date"/>
  	<result property="lastModifiedUser" column="last_modified_user"/>
  </resultMap>

  
	<select id="getTask" resultMap="taskMap">
		select * from Task where idtask = #{taskId}
	</select>

	<select id="getTasksByStory" resultMap="taskMap">
		select * from Task
		join Story on story.idstory = task.idtask
		where story.idstory = #{storyId}
	</select>
	
	<insert id="insertTask" useGeneratedKeys="true" keyProperty="id" keyColumn="idtask">
	    insert into Task (name, description, start_date, end_date, create_date, create_user, last_modified_date, last_modified_user) 
	    values (#{name}, #{description}, #{startDate}, #{endDate}, now(), #{createUser}, now(), #{lastModifiedUser}) 
	</insert>
	
	<delete id="deleteTask">
	    delete from Task where idtask = #{id}
	</delete>
  
</mapper>

